function U_new = update_U(X, F, U, lambda_s, alpha_v)
% =========================================================================
% 更新特征选择矩阵 U (U-step)
% 包含最小二乘求解和 L2,1 近端算子
% =========================================================================

[n, d] = size(X);
c = size(F, 2);

% --- 1. 求解最小二乘问题 ---
% min ||XU - F||_F^2  => (X'X)U = X'F
% 为了数值稳定性，加入微小的正则项
A = X' * X + 1e-7 * eye(d);
B = X' * F;

% 解线性方程组
U_ls = A \ B;

% --- 2. 应用 L2,1 范数的近端算子 ---
U_new = prox_L21(U_ls, lambda_s * alpha_v); % 注意权重也应乘以alpha_v

end
